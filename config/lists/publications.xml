<?xml version="1.0" ?>
<list xmlns="http://schemas.sulu.io/list-builder/list">
    <key>publications</key>

    <joins name="dimensionContent">
        <join>
            <entity-name>dimensionContent</entity-name>
            <field-name>App\Entity\Publication.dimensionContents</field-name>
            <method>LEFT</method>
            <condition>dimensionContent.locale = :locale AND dimensionContent.stage = 'draft'</condition>
        </join>
    </joins>

    <joins name="unlocalizedDimensionContent">
        <join>
            <entity-name>unlocalizedDimensionContent</entity-name>
            <field-name>App\Entity\Publication.dimensionContents</field-name>
            <method>LEFT</method>
            <condition>unlocalizedDimensionContent.locale IS NULL AND unlocalizedDimensionContent.stage = 'draft'</condition>
        </join>
    </joins>

    <joins name="ghostDimensionContent" ref="unlocalizedDimensionContent">
        <join>
            <entity-name>ghostDimensionContent</entity-name>
            <field-name>App\Entity\Publication.dimensionContents</field-name>
            <method>LEFT</method>
            <condition>ghostDimensionContent.locale = unlocalizedDimensionContent.ghostLocale AND ghostDimensionContent.stage = 'draft'</condition>
        </join>
    </joins>

    <joins name="changer" ref="dimensionContent">
        <join>
            <entity-name>%sulu.model.user.class%_changer</entity-name>
            <field-name>dimensionContent.changer</field-name>
        </join>
        <join>
            <entity-name>%sulu.model.contact.class%_changer</entity-name>
            <field-name>%sulu.model.user.class%_changer.contact</field-name>
        </join>
    </joins>

    <joins name="creator" ref="dimensionContent">
        <join>
            <entity-name>%sulu.model.user.class%_creator</entity-name>
            <field-name>dimensionContent.creator</field-name>
        </join>
        <join>
            <entity-name>%sulu.model.contact.class%_creator</entity-name>
            <field-name>%sulu.model.user.class%_creator.contact</field-name>
        </join>
    </joins>

    <properties>
        <property name="id" translation="sulu_admin.id">
            <field-name>id</field-name>
            <entity-name>App\Entity\Publication</entity-name>
        </property>

        <case-property name="title" translation="sulu_admin.title" visibility="always" searchability="yes">
            <field>
                <field-name>title</field-name>
                <entity-name>dimensionContent</entity-name>

                <joins ref="dimensionContent"/>
            </field>

            <field>
                <field-name>title</field-name>
                <entity-name>ghostDimensionContent</entity-name>

                <joins ref="ghostDimensionContent"/>
            </field>

            <transformer type="title"/>
        </case-property>

        <property name="notified" translation="app.admin.notified">
            <field-name>notified</field-name>
            <entity-name>App\Entity\Publication</entity-name>

            <transformer type="bool"/>
        </property>

        <property name="created" translation="sulu_admin.created" type="datetime" visibility="yes">
            <field-name>created</field-name>
            <entity-name>dimensionContent</entity-name>

            <joins ref="dimensionContent"/>
        </property>

        <concatenation-property name="creator" translation="sulu_admin.creator" visibility="no" searchability="yes">
            <field>
                <field-name>firstName</field-name>
                <entity-name>%sulu.model.contact.class%_creator</entity-name>

                <joins ref="creator"/>
            </field>
            <field>
                <field-name>lastName</field-name>
                <entity-name>%sulu.model.contact.class%_creator</entity-name>

                <joins ref="creator"/>
            </field>

            <filter type="selection">
                <params>
                    <param name="displayProperty" value="fullName" />
                    <param name="resourceKey" value="contacts" />
                </params>
            </filter>
        </concatenation-property>

        <property name="changed" translation="sulu_admin.changed" type="datetime" visibility="yes">
            <field-name>changed</field-name>
            <entity-name>dimensionContent</entity-name>

            <joins ref="dimensionContent"/>
        </property>

        <concatenation-property name="changer" translation="sulu_admin.changer" visibility="no" searchability="yes">
            <field>
                <field-name>firstName</field-name>
                <entity-name>%sulu.model.contact.class%_changer</entity-name>

                <joins ref="changer"/>
            </field>
            <field>
                <field-name>lastName</field-name>
                <entity-name>%sulu.model.contact.class%_changer</entity-name>

                <joins ref="changer"/>
            </field>

            <filter type="selection">
                <params>
                    <param name="displayProperty" value="fullName" />
                    <param name="resourceKey" value="contacts" />
                </params>
            </filter>
        </concatenation-property>

        <property name="locale" translation="sulu_admin.locale" visibility="never">
            <field-name>locale</field-name>
            <entity-name>dimensionContent</entity-name>

            <joins ref="dimensionContent"/>
        </property>

        <property name="ghostLocale" translation="sulu_admin.ghost_locale" visibility="never">
            <field-name>ghostLocale</field-name>
            <entity-name>unlocalizedDimensionContent</entity-name>

            <joins ref="unlocalizedDimensionContent"/>
        </property>
    </properties>
</list>
